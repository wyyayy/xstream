(function(e){"object"===typeof exports&&"undefined"!==typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).xstream=e()})(function(){return function(){function e(k,h,d){function r(m,l){if(!h[m]){if(!k[m]){var c="function"==typeof require&&require;if(!l&&c)return c(m,!0);if(p)return p(m,!0);l=Error("Cannot find module '"+m+"'");throw l.code="MODULE_NOT_FOUND",l;
}l=h[m]={exports:{}};k[m][0].call(l.exports,function(c){return r(k[m][1][c]||c)},l,l.exports,e,k,h,d)}return h[m].exports}for(var p="function"==typeof require&&require,q=0;q<d.length;q++)r(d[q]);return r}return e}()({1:[function(e,k,h){function d(){}function r(a,b){return function(f){return a(f)&&b(f)}}function p(a,b,f){try{return a.f(b)}catch(g){return f._e(g),c}}function q(a){a._start=function(b){b.next=b._n;b.error=b._e;b.complete=b._c;this.start(b)};a._stop=a.stop}var m=this&&this.__extends||
function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,f){b.__proto__=f}||function(b,f){for(var a in f)f.hasOwnProperty(a)&&(b[a]=f[a])};return function(b,f){function c(){this.constructor=b}a(b,f);b.prototype=null===f?Object.create(f):(c.prototype=f.prototype,new c)}}();Object.defineProperty(h,"__esModule",{value:!0});var l=e("symbol-observable"),c={};h.NO=c;var t={_n:d,_e:d,_c:d};h.NO_IL=t;var w=function(){function a(b,f){this._stream=b;this._listener=f}a.prototype.unsubscribe=
function(){this._stream._remove(this._listener)};return a}(),y=function(){function a(b){this._listener=b}a.prototype.next=function(b){this._listener._n(b)};a.prototype.error=function(b){this._listener._e(b)};a.prototype.complete=function(){this._listener._c()};return a}(),z=function(){function a(b){this.type="fromObservable";this.ins=b;this.active=!1}a.prototype._start=function(b){this.out=b;this.active=!0;this._sub=this.ins.subscribe(new y(b));this.active||this._sub.unsubscribe()};a.prototype._stop=
function(){this._sub&&this._sub.unsubscribe();this.active=!1};return a}(),A=function(){function a(b){this.type="merge";this.insArr=b;this.output=c;this.ac=0}a.prototype._start=function(b){this.output=b;b=this.insArr;var f=b.length;this.ac=f;for(var a=0;a<f;a++)b[a]._add(this)};a.prototype._stop=function(){for(var b=this.insArr,f=b.length,a=0;a<f;a++)b[a]._remove(this);this.output=c};a.prototype._n=function(b){var a=this.output;a!==c&&a._n(b)};a.prototype._e=function(b){var a=this.output;a!==c&&a._e(b)};
a.prototype._c=function(){if(0>=--this.ac){var b=this.output;b!==c&&b._c()}};return a}(),C=function(){function a(b,a,c){this.i=b;this.output=a;this.p=c;c.ils.push(this)}a.prototype._n=function(b){var a=this.p,g=this.output;if(g!==c&&a.up(b,this.i)){b=a.vals;a=b.length;for(var u=Array(a),d=0;d<a;++d)u[d]=b[d];g._n(u)}};a.prototype._e=function(b){var a=this.output;a!==c&&a._e(b)};a.prototype._c=function(){var b=this.p;b.output!==c&&0===--b.Nc&&b.output._c()};return a}(),D=function(){function a(b){this.type=
"combine";this.insArr=b;this.output=c;this.ils=[];this.Nc=this.Nn=0;this.vals=[]}a.prototype.up=function(b,a){var f=this.vals[a];f=this.Nn?f===c?--this.Nn:this.Nn:0;this.vals[a]=b;return 0===f};a.prototype._start=function(b){this.output=b;var a=this.insArr,g=this.Nc=this.Nn=a.length,d=this.vals=Array(g);if(0===g)b._n([]),b._c();else for(var e=0;e<g;e++)d[e]=c,a[e]._add(new C(e,b,this))};a.prototype._stop=function(){for(var b=this.insArr,a=b.length,g=this.ils,d=0;d<a;d++)b[d]._remove(g[d]);this.output=
c;this.ils=[];this.vals=[]};return a}(),E=function(){function a(b){this.type="fromArray";this.a=b}a.prototype._start=function(b){for(var a=this.a,c=0,d=a.length;c<d;c++)b._n(a[c]);b._c()};a.prototype._stop=function(){};return a}(),F=function(){function a(b){this.type="fromPromise";this.on=!1;this.p=b}a.prototype._start=function(b){var a=this;this.on=!0;this.p.then(function(f){a.on&&(b._n(f),b._c())},function(a){b._e(a)}).then(d,function(b){setTimeout(function(){throw b;})})};a.prototype._stop=function(){this.on=
!1};return a}(),G=function(){function a(b){this.type="periodic";this.period=b;this.intervalID=-1;this.i=0}a.prototype._start=function(b){var a=this;this.intervalID=setInterval(function(){b._n(a.i++)},this.period)};a.prototype._stop=function(){-1!==this.intervalID&&clearInterval(this.intervalID);this.intervalID=-1;this.i=0};return a}(),H=function(){function a(b,a){this.type="debug";this.input=b;this.output=c;this.s=d;this.l="";"string"===typeof a?this.l=a:"function"===typeof a&&(this.s=a)}a.prototype._start=
function(b){this.output=b;this.input._add(this)};a.prototype._stop=function(){this.input._remove(this);this.output=c};a.prototype._n=function(b){var a=this.output;if(a!==c){var g=this.s,u=this.l;if(g!==d)try{g(b)}catch(B){a._e(B)}else u?console.log(u+":",b):console.log(b);a._n(b)}};a.prototype._e=function(b){var a=this.output;a!==c&&a._e(b)};a.prototype._c=function(){var b=this.output;b!==c&&b._c()};return a}(),I=function(){function a(b,a){this.type="drop";this.input=a;this.output=c;this.max=b;this.dropped=
0}a.prototype._start=function(b){this.output=b;this.dropped=0;this.input._add(this)};a.prototype._stop=function(){this.input._remove(this);this.output=c};a.prototype._n=function(b){var a=this.output;a!==c&&this.dropped++>=this.max&&a._n(b)};a.prototype._e=function(b){var a=this.output;a!==c&&a._e(b)};a.prototype._c=function(){var b=this.output;b!==c&&b._c()};return a}(),J=function(){function a(b,a){this.endWhen=b;this._evt=a}a.prototype.start=function(){this._evt._add(this)};a.prototype.stop=function(){this._evt._remove(this)};
a.prototype._n=function(){this.endWhen.end()};a.prototype._e=function(b){this.endWhen._e(b)};a.prototype._c=function(){this.endWhen.end()};return a}(),K=function(){function a(b,a){this.type="endWhen";this.input=a;this.output=c;this._impl=new J(this,b)}a.prototype._start=function(b){this.output=b;this._impl.start();this.input._add(this)};a.prototype._stop=function(){this.input._remove(this,!0);this._impl.stop();this.output=c};a.prototype.end=function(){this.output!==c&&this.output._c()};a.prototype._n=
function(b){this.output!==c&&this.output._n(b)};a.prototype._e=function(b){this.output!==c&&this.output._e(b)};a.prototype._c=function(){this.end()};return a}(),x=function(){function a(b,a){this.type="filter";this.input=a;this.output=c;this.f=b}a.prototype._start=function(b){this.output=b;this.input._add(this)};a.prototype._stop=function(){this.input._remove(this);this.output=c};a.prototype._n=function(b){var a=this.output;if(a!==c){var g=p(this,b,a);g!==c&&g&&a._n(b)}};a.prototype._e=function(b){var a=
this.output;a!==c&&a._e(b)};a.prototype._c=function(){var b=this.output;b!==c&&b._c()};return a}(),L=function(){function a(b,a){this.out=b;this.op=a}a.prototype._n=function(b){this.out._n(b)};a.prototype._e=function(b){this.out._e(b)};a.prototype._c=function(){this.op.inner=c;this.op.less()};return a}(),M=function(){function a(b){this.type="flatten";this.input=b;this.output=c;this.open=!0;this.inner=c;this.il=t}a.prototype._start=function(b){this.output=b;this.open=!0;this.inner=c;this.il=t;this.input._add(this)};
a.prototype._stop=function(){this.input._remove(this);this.inner!==c&&this.inner._remove(this.il);this.output=c;this.open=!0;this.inner=c;this.il=t};a.prototype.less=function(){var b=this.output;b!==c&&(this.open||this.inner!==c||b._c())};a.prototype._n=function(b){var a=this.output;if(a!==c){var g=this.inner,d=this.il;g!==c&&d!==t&&g._remove(d);(this.inner=b)._add(this.il=new L(a,this))}};a.prototype._e=function(b){var a=this.output;a!==c&&a._e(b)};a.prototype._c=function(){this.open=!1;this.less()};
return a}(),N=function(){function a(b,a,g){var f=this;this.type="fold";this.input=g;this.output=c;this.f=function(a){return b(f.acc,a)};this.acc=this.seed=a}a.prototype._start=function(b){this.output=b;this.acc=this.seed;b._n(this.acc);this.input._add(this)};a.prototype._stop=function(){this.input._remove(this);this.output=c;this.acc=this.seed};a.prototype._n=function(b){var a=this.output;a!==c&&(b=p(this,b,a),b!==c&&a._n(this.acc=b))};a.prototype._e=function(b){var a=this.output;a!==c&&a._e(b)};
a.prototype._c=function(){var b=this.output;b!==c&&b._c()};return a}(),O=function(){function a(b){this.type="last";this.input=b;this.output=c;this.has=!1;this.val=c}a.prototype._start=function(b){this.output=b;this.has=!1;this.input._add(this)};a.prototype._stop=function(){this.input._remove(this);this.val=this.output=c};a.prototype._n=function(b){this.has=!0;this.val=b};a.prototype._e=function(b){var a=this.output;a!==c&&a._e(b)};a.prototype._c=function(){var b=this.output;b!==c&&(this.has?(b._n(this.val),
b._c()):b._e(Error("last() failed because input stream completed")))};return a}(),P=function(){function a(b,a){this.type="map";this.input=a;this.output=c;this.f=b}a.prototype._start=function(b){this.output=b;this.input._add(this)};a.prototype._stop=function(){this.input._remove(this);this.output=c};a.prototype._n=function(b){var a=this.output;a!==c&&(b=p(this,b,a),b!==c&&a._n(b))};a.prototype._e=function(b){var a=this.output;a!==c&&a._e(b)};a.prototype._c=function(){var b=this.output;b!==c&&b._c()};
return a}(),Q=function(){function a(b){this.type="remember";this.ins=b;this.out=c}a.prototype._start=function(b){this.out=b;this.ins._add(b)};a.prototype._stop=function(){this.ins._remove(this.out);this.out=c};return a}(),R=function(){function a(b,a){this.type="replaceError";this.input=a;this.output=c;this.f=b}a.prototype._start=function(b){this.output=b;this.input._add(this)};a.prototype._stop=function(){this.input._remove(this);this.output=c};a.prototype._n=function(b){var a=this.output;a!==c&&
a._n(b)};a.prototype._e=function(b){var a=this.output;if(a!==c)try{this.input._remove(this),(this.input=this.f(b))._add(this)}catch(g){a._e(g)}};a.prototype._c=function(){var b=this.output;b!==c&&b._c()};return a}(),S=function(){function a(b,a){this.type="startWith";this.ins=b;this.out=c;this.val=a}a.prototype._start=function(b){this.out=b;this.out._n(this.val);this.ins._add(b)};a.prototype._stop=function(){this.ins._remove(this.out);this.out=c};return a}(),T=function(){function a(b,a){this.type=
"take";this.input=a;this.output=c;this.max=b;this.taken=0}a.prototype._start=function(b){this.output=b;this.taken=0;0>=this.max?b._c():this.input._add(this)};a.prototype._stop=function(){this.input._remove(this,!0);this.output=c};a.prototype._n=function(b){var a=this.output;if(a!==c){var g=++this.taken;g<this.max?a._n(b):g===this.max&&(a._n(b),a._c())}};a.prototype._e=function(b){var a=this.output;a!==c&&a._e(b)};a.prototype._c=function(){var b=this.output;b!==c&&b._c()};return a}(),v;(function(a){a[a.Next=
0]="Next";a[a.Error=1]="Error";a[a.Complete=2]="Complete"})(v=h.RxEvtType||(h.RxEvtType={}));e=function(){function a(b){this._prod=b||c;this._ils=[];this._dl=this._stopID=c;this._d=!1;this._err=this._target=c}a.prototype._n=function(b){var a=this._ils,c=a.length;this._d&&this._dl._n(b);if(1===c)a[0]._n(b);else if(0!==c){a=a.slice(0);for(var d=0;d<c;d++)a[d]._n(b)}};a.prototype._e=function(b){if(this._err===c){this._err=b;var a=this._ils,d=a.length;this._x();this._d&&this._dl._e(b);if(1===d)a[0]._e(b);
else{if(0===d)return;a=a.slice(0);for(var e=0;e<d;e++)a[e]._e(b)}if(!this._d&&0===d)throw this._err;}};a.prototype._c=function(){var b=this._ils,a=b.length;this._x();this._d&&this._dl._c();if(1===a)b[0]._c();else if(0!==a){b=b.slice(0);for(var c=0;c<a;c++)b[c]._c()}};a.prototype._x=function(){0!==this._ils.length&&(this._prod!==c&&this._prod._stop(),this._err=c,this._ils=[])};a.prototype._stopNow=function(){this._prod._stop();this._stopID=this._err=c};a.prototype._add=function(b){var a=this._target;
if(a!==c)return a._add(b);a=this._ils;a.push(b);1<a.length||(this._stopID!==c?(clearTimeout(this._stopID),this._stopID=c):(b=this._prod,b!==c&&b._start(this)))};a.prototype._remove=function(b,a){var f=this;void 0===a&&(a=!1);var d=this._target;if(d!==c)return d._remove(b);d=this._ils;b=d.indexOf(b);-1<b&&(d.splice(b,1),this._prod!==c&&0>=d.length?(this._err=c,a?this._stopNow():this._stopID=setTimeout(function(){return f._stopNow()})):1===d.length&&this._pruneCycles())};a.prototype._pruneCycles=function(){this._hasNoSinks(this,
[])&&this._remove(this._ils[0])};a.prototype._hasNoSinks=function(b,a){if(-1!==a.indexOf(b)||b.output===this)return!0;if(b.output&&b.output!==c)return this._hasNoSinks(b.output,a.concat(b));if(b._ils){for(var f=0,d=b._ils.length;f<d;f++)if(!this._hasNoSinks(b._ils[f],a.concat(b)))return!1;return!0}return!1};a.prototype.ctor=function(){return this instanceof n?n:a};a.prototype.addListener=function(b){b._n=b.next||d;b._e=b.error||d;b._c=b.complete||d;this._add(b)};a.prototype.removeListener=function(b){this._remove(b)};
a.prototype.subscribe=function(b){if("object"===typeof b)return this.addListener(b),new w(this,b);var a={};1===b.length?(a.next=b,a.error=d,a.complete=d):(a.next=d,a.error=d,a.complete=b);this.addListener(a);return new w(this,a)};a.prototype.subscribeOf=function(a,c){void 0===c&&(c=v.Next);var b={};b.next=c===v.Next?a:d;b.error=c===v.Error?a:d;b.complete=c===v.Complete?a:d;this.addListener(b);return new w(this,b)};a.prototype[l.default]=function(){return this};a.create=function(b){if(b){if("function"!==
typeof b.start||"function"!==typeof b.stop)throw Error("producer requires both start and stop functions");q(b)}return new a(b)};a.createWithMemory=function(a){a&&q(a);return new n(a)};a.never=function(){return new a({_start:d,_stop:d})};a.empty=function(){return new a({_start:function(a){a._c()},_stop:d})};a.throw=function(b){return new a({_start:function(a){a._e(b)},_stop:d})};a.from=function(b){if("function"===typeof b[l.default])return a.fromObservable(b);if("function"===typeof b.then)return a.fromPromise(b);
if(Array.isArray(b))return a.fromArray(b);throw new TypeError("Type of input to from() must be an Array, Promise, or Observable");};a.of=function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return a.fromArray(b)};a.fromArray=function(b){return new a(new E(b))};a.fromPromise=function(b){return new a(new F(b))};a.fromObservable=function(b){if(b.endWhen)return b;b="function"===typeof b[l.default]?b[l.default]():b;return new a(new z(b))};a.periodic=function(b){return new a(new G(b))};
a.prototype._map=function(a){return new (this.ctor())(new P(a,this))};a.prototype.map=function(a){return this._map(a)};a.prototype.mapTo=function(a){var b=this.map(function(){return a});b._prod.type="mapTo";return b};a.prototype.filter=function(b){var c=this._prod;return c instanceof x?new a(new x(r(c.f,b),c.input)):new a(new x(b,this))};a.prototype.take=function(a){return new (this.ctor())(new T(a,this))};a.prototype.drop=function(b){return new a(new I(b,this))};a.prototype.last=function(){return new a(new O(this))};
a.prototype.startWith=function(a){return new n(new S(this,a))};a.prototype.endWhen=function(a){return new (this.ctor())(new K(a,this))};a.prototype.fold=function(a,c){return new n(new N(a,c,this))};a.prototype.replaceError=function(a){return new (this.ctor())(new R(a,this))};a.prototype.flatten=function(){return new a(new M(this))};a.prototype.compose=function(a){return a(this)};a.prototype.remember=function(){return new n(new Q(this))};a.prototype.debug=function(a){return new (this.ctor())(new H(this,
a))};a.prototype.imitate=function(a){if(a instanceof n)throw Error("A MemoryStream was given to imitate(), but it only supports a Stream. Read more about this restriction here: https://github.com/staltz/xstream#faq");this._target=a;for(var b=this._ils,c=b.length,d=0;d<c;d++)a._add(b[d]);this._ils=[]};a.prototype.shamefullySendNext=function(a){this._n(a)};a.prototype.shamefullySendError=function(a){this._e(a)};a.prototype.shamefullySendComplete=function(){this._c()};a.prototype.setDebugListener=function(a){a?
(this._d=!0,a._n=a.next||d,a._e=a.error||d,a._c=a.complete||d,this._dl=a):(this._d=!1,this._dl=c)};a.merge=function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return new a(new A(b))};a.combine=function(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];return new a(new D(b))};return a}();h.Stream=e;var n=function(a){function b(b){b=a.call(this,b)||this;b._has=!1;return b}m(b,a);b.prototype._n=function(b){this._v=b;this._has=!0;a.prototype._n.call(this,b)};b.prototype._add=
function(a){var b=this._target;if(b!==c)return b._add(a);b=this._ils;b.push(a);1<b.length?this._has&&a._n(this._v):this._stopID!==c?(this._has&&a._n(this._v),clearTimeout(this._stopID),this._stopID=c):this._has?a._n(this._v):(a=this._prod,a!==c&&a._start(this))};b.prototype._stopNow=function(){this._has=!1;a.prototype._stopNow.call(this)};b.prototype._x=function(){this._has=!1;a.prototype._x.call(this)};b.prototype.map=function(a){return this._map(a)};b.prototype.mapTo=function(b){return a.prototype.mapTo.call(this,
b)};b.prototype.take=function(b){return a.prototype.take.call(this,b)};b.prototype.endWhen=function(b){return a.prototype.endWhen.call(this,b)};b.prototype.replaceError=function(b){return a.prototype.replaceError.call(this,b)};b.prototype.remember=function(){return this};b.prototype.debug=function(b){return a.prototype.debug.call(this,b)};return b}(e);h.MemoryStream=n;h.default=e},{"symbol-observable":2}],2:[function(e,k,h){var d="undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==
typeof window?window:{};Object.defineProperty(h,"__esModule",{value:!0});e=(e=e("./ponyfill.js"))&&e.__esModule?e:{"default":e};k="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof d?d:"undefined"!==typeof k?k:Function("return this")();k=(0,e["default"])(k);h["default"]=k},{"./ponyfill.js":3}],3:[function(e,k,h){Object.defineProperty(h,"__esModule",{value:!0});h["default"]=function(d){var e=d.Symbol;"function"===typeof e?e.observable?d=e.observable:(d=e("observable"),
e.observable=d):d="@@observable";return d}},{}]},{},[1])(1)});